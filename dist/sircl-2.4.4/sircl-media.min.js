typeof sircl=="undefined"&&console.warn("The 'sircl-media' component should be registered after the 'sircl' component. Please review order of script files.");sircl.isElementInView=sircl.isElementInView||function(n){var t=n.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)};document.addEventListener("DOMContentLoaded",function(){$(document).on("click","[onclick-resetmedia]",function(){sircl.ext.$select($(this),$(this).attr("onclick-resetmedia")).each(function(){(this.srcObject!=null||this.currentSrc!="")&&this.pause();this.currentTime=0})});$(document).on("click","[onclick-playmedia]",function(){sircl.ext.$select($(this),$(this).attr("onclick-playmedia")).each(function(){(this.srcObject!=null||this.currentSrc!="")&&this.play()})});$(document).on("click","[onclick-pausemedia]",function(){sircl.ext.$select($(this),$(this).attr("onclick-pausemedia")).each(function(){(this.srcObject!=null||this.currentSrc!="")&&this.pause()})});$(document).on("click","[onclick-toggleplaymedia]",function(){sircl.ext.$select($(this),$(this).attr("onclick-toggleplaymedia")).each(function(){this.ended?(this.srcObject!=null||this.currentSrc!="")&&this.play():this.paused?(this.srcObject!=null||this.currentSrc!="")&&this.play():(this.srcObject!=null||this.currentSrc!="")&&this.pause()})});$(document).on("click","[onclick-takepicture]",function(){sircl.ext.$select($(this),$(this).attr("onclick-takepicture")).filter("VIDEO").each(function(){var t=this,n=null;sircl.ext.$select($(this),this.getAttribute("picture-canvas")).filter("CANVAS").each(function(){var n=this,i;n.height=t.videoHeight/(t.videoWidth/n.width);i=n.getContext("2d");i.drawImage(t,0,0,n.width,n.height)});sircl.ext.$select($(this),this.getAttribute("picture-fileinput")).filter("INPUT[type=file]").each(function(){n==null&&(n=document.createElement("canvas"),n.width=t.videoWidth,n.height=t.videoHeight,n.getContext("2d").drawImage(t,0,0,n.width,n.height));n.toBlob(n=>{if(n){var i=t.getAttribute("picture-filename")||"picture.png",u=t.getAttribute("picture-filetype")||(i.toLowerCase().endsWith(".jpg")?"image/jpeg":i.toLowerCase().endsWith(".jpeg")?"image/jpeg":"image/png"),f=new File([n],i,{type:u}),r=new DataTransfer;r.items.add(f);this.files=r.files;$(this).trigger("change")}},"image/jpeg")});sircl.ext.$select($(this),this.getAttribute("picture-img")).filter("IMG").each(function(){n==null&&(n=document.createElement("canvas"),n.width=t.videoWidth,n.height=t.videoHeight,n.getContext("2d").drawImage(t,0,0,n.width,n.height));var i=n.toDataURL("image/png");this.setAttribute("src",i)});sircl.ext.$select($(this),this.getAttribute("picture-imgref")).filter("IMG").each(function(){n==null&&(n=document.createElement("canvas"),n.width=t.videoWidth,n.height=t.videoHeight,n.getContext("2d").drawImage(t,0,0,n.width,n.height));n.toBlob(n=>{this.setAttribute("src",URL.createObjectURL(n))},"image/jpeg")})})});$(document).on("change","[onchange-setvideosource]",function(){var n=sircl.ext.effectiveValue(this);sircl.ext.$select($(this),$(this).attr("onchange-setvideosource")).filter("VIDEO").each(function(){this.paused||(this.dispatchEvent(new Event("pause",{bubbles:!1,cancelable:!1})),this.dispatchEvent(new Event("ended",{bubbles:!1,cancelable:!1})));var t=!this.paused;this.srcObject!=null&&(this.srcObject.getTracks().forEach(function(n){n.stop()}),this.srcObject=null);n!=""&&navigator.mediaDevices.getUserMedia({video:{deviceId:n}}).then(n=>{this.srcObject=n,t&&this.play()}).catch(n=>{console.error("Sircl [onchange-setvideosource]: An error occurred.",n)})})});$(document).on("change","INPUT[ifchecked-playmedia]",function(){var n=this;sircl.ext.$select($(this),$(this).attr("ifchecked-playmedia")).each(function(){n.checked==this.paused&&(this.paused?this.play():this.pause())})});$(window).on("DOMContentLoaded load resize scroll",function(){$("AUDIO.ifinview-playmedia, VIDEO.ifinview-playmedia").each(function(){sircl.isElementInView(this)&&(this.srcObject!=null||this.currentSrc!="")&&this.paused&&this.play()});$("AUDIO.ifnotinview-pausemedia, VIDEO.ifnotinview-pausemedia").each(function(){sircl.isElementInView(this)||(this.srcObject!=null||this.currentSrc!="")&&(this.paused||this.pause())})})});$$("before",function(){$(this).find("AUDIO, VIDEO").each(function(){this.srcObject!=null&&(this.srcObject.getTracks().forEach(function(n){n.stop()}),this.srcObject=null)})});$$(function(){$(this).find("[onplaymedia-hide]").each(function(){this.addEventListener("play",function(){sircl.ext.visible(sircl.ext.$select($(this),$(this).attr("onplaymedia-hide")),!1,!0)})});$(this).find("[onwaitingmedia-hide]").each(function(){this.addEventListener("waiting",function(){sircl.ext.visible(sircl.ext.$select($(this),$(this).attr("onwaitingmedia-hide")),!1,!0)})});$(this).find("[onplayingmedia-hide]").each(function(){this.addEventListener("playing",function(){sircl.ext.visible(sircl.ext.$select($(this),$(this).attr("onplayingmedia-hide")),!1,!0)})});$(this).find("[onpausemedia-hide]").each(function(){this.addEventListener("pause",function(){sircl.ext.visible(sircl.ext.$select($(this),$(this).attr("onpausemedia-hide")),!1,!0)})});$(this).find("[onendedmedia-hide]").each(function(){this.addEventListener("ended",function(){sircl.ext.visible(sircl.ext.$select($(this),$(this).attr("onendedmedia-hide")),!1,!0)})});$(this).find("[onplaymedia-show]").each(function(){this.addEventListener("play",function(){sircl.ext.visible(sircl.ext.$select($(this),$(this).attr("onplaymedia-show")),!0,!0)})});$(this).find("[onwaitingmedia-show]").each(function(){this.addEventListener("waiting",function(){sircl.ext.visible(sircl.ext.$select($(this),$(this).attr("onwaitingmedia-show")),!0,!0)})});$(this).find("[onplayingmedia-show]").each(function(){this.addEventListener("playing",function(){sircl.ext.visible(sircl.ext.$select($(this),$(this).attr("onplayingmedia-show")),!0,!0)})});$(this).find("[onpausemedia-show]").each(function(){this.addEventListener("pause",function(){sircl.ext.visible(sircl.ext.$select($(this),$(this).attr("onpausemedia-show")),!0,!0)})});$(this).find("[onendedmedia-show]").each(function(){this.addEventListener("ended",function(){sircl.ext.visible(sircl.ext.$select($(this),$(this).attr("onendedmedia-show")),!0,!0)})});$(this).find("[onplaymedia-disable]").each(function(){this.addEventListener("play",function(){sircl.ext.enabled(sircl.ext.$select($(this),$(this).attr("onplaymedia-disable")),!1)})});$(this).find("[onwaitingmedia-disable]").each(function(){this.addEventListener("waiting",function(){sircl.ext.enabled(sircl.ext.$select($(this),$(this).attr("onwaitingmedia-disable")),!1)})});$(this).find("[onplayingmedia-disable]").each(function(){this.addEventListener("playing",function(){sircl.ext.enabled(sircl.ext.$select($(this),$(this).attr("onplayingmedia-disable")),!1)})});$(this).find("[onpausemedia-disable]").each(function(){this.addEventListener("pause",function(){sircl.ext.enabled(sircl.ext.$select($(this),$(this).attr("onpausemedia-disable")),!1)})});$(this).find("[onendedmedia-disable]").each(function(){this.addEventListener("ended",function(){sircl.ext.enabled(sircl.ext.$select($(this),$(this).attr("onendedmedia-disable")),!1)})});$(this).find("[onplaymedia-enable]").each(function(){this.addEventListener("play",function(){sircl.ext.enabled(sircl.ext.$select($(this),$(this).attr("onplaymedia-enable")),!0)})});$(this).find("[onwaitingmedia-enable]").each(function(){this.addEventListener("waiting",function(){sircl.ext.enabled(sircl.ext.$select($(this),$(this).attr("onwaitingmedia-enable")),!0)})});$(this).find("[onplayingmedia-enable]").each(function(){this.addEventListener("playing",function(){sircl.ext.enabled(sircl.ext.$select($(this),$(this).attr("onplayingmedia-enable")),!0)})});$(this).find("[onpausemedia-enable]").each(function(){this.addEventListener("pause",function(){sircl.ext.enabled(sircl.ext.$select($(this),$(this).attr("onpausemedia-enable")),!0)})});$(this).find("[onendedmedia-enable]").each(function(){this.addEventListener("ended",function(){sircl.ext.enabled(sircl.ext.$select($(this),$(this).attr("onendedmedia-enable")),!0)})});$(this).find("[onplaymedia-removeclass]").each(function(){this.addEventListener("play",function(){sircl.ext.removeClass($(this),$(this).attr("onplaymedia-removeclass"))})});$(this).find("[onpausemedia-removeclass]").each(function(){this.addEventListener("pause",function(){sircl.ext.removeClass($(this),$(this).attr("onpausemedia-removeclass"))})});$(this).find("[onplaymedia-addclass]").each(function(){this.addEventListener("play",function(){sircl.ext.addClass($(this),$(this).attr("onplaymedia-addclass"))})});$(this).find("[onpausemedia-addclass]").each(function(){this.addEventListener("pause",function(){sircl.ext.addClass($(this),$(this).attr("onpausemedia-addclass"))})});$(this).find("[onplaymedia-check]").each(function(){this.addEventListener("play",function(){sircl.ext.$select($(this),$(this).attr("onplaymedia-check")).filter("INPUT:where([type='checkbox'], [type='radio'])").each(function(){this.checked||(this.checked=!0,$(this).trigger("change"))})});this.addEventListener("pause",function(){sircl.ext.$select($(this),$(this).attr("onplaymedia-check")).filter("INPUT:where([type='checkbox'], [type='radio'])").each(function(){this.checked&&(this.checked=!1,$(this).trigger("change"))})})});$(this).find("[onplaymedia-click]").each(function(){this.addEventListener("play",function(){var n=$(this).attr("onplaymedia-click");sircl.ext.$select($(this),n).each(function(){this.click()})})});$(this).find("[onpausemedia-click]").each(function(){this.addEventListener("pause",function(){var n=$(this).attr("onpausemedia-click");sircl.ext.$select($(this),n).each(function(){this.click()})})});$(this).find("[onendedmedia-click]").each(function(){this.addEventListener("ended",function(){var n=$(this).attr("onendedmedia-click");sircl.ext.$select($(this),n).each(function(){this.click()})})});$(this).find("SELECT.onload-addvideodevices").each(function(){if(this.classList.remove("onload-addvideodevices"),navigator.mediaDevices==null||navigator.mediaDevices.enumerateDevices==null)console.warn("Sircl .onload-addvideodevices: enumerateDevices() not supported.");else{var n=0;navigator.mediaDevices.enumerateDevices().then(t=>{t.forEach(t=>{if(t.kind==="videoinput"&&t.deviceId!=""){var i=document.createElement("option");i.value=t.deviceId;i.text=t.label||"Camera "+ ++n;this.add(i)}})}).catch(n=>{console.warn("Sircl .onload-addvideodevices: error enumerating devices.",n)})}});$(this).find("VIDEO[onload-setvideosource]").each(function(){var n={video:!0,audio:!1},t=this.getAttribute("onload-setvideosource"),i=!this.hasAttribute("muted");n=t==="any"?{video:!0,audio:i}:{video:{facingMode:{ideal:t}},audio:i};navigator.mediaDevices.getUserMedia(n).then(n=>{this.srcObject=n,this.hasAttribute("autplay")&&this.play()}).catch(n=>{console.warn("Sircl [onload-setvideosource]: error setting video source.",n)})})});sircl.barcode_readinterval=200;sircl.mediaStartBarcodeScanner=function(n){"BarcodeDetector"in window&&n!=null&&n._barcodeScannerInterval==null&&BarcodeDetector.getSupportedFormats().then(t=>{for(var u=[],r=(n.getAttribute("barcode-formats")||"qr_code").split(" "),i=0;i<r.length;i++)t.includes(r[i])?u.push(r[i]):console.warn('Sircl .barcode-scanner: barcode format "'+r[i]+'" not supported.');n._barcodeScanner=new BarcodeDetector({formats:u});n._barcodeScannerInterval=window.setInterval(function(n){n._barcodeScanner.detect(n).then(function(t){if(t.length!==0)if(n.pause(),n.classList.contains("onbarcodedetected-navigate")&&(t[0].rawValue.toLowerCase().startsWith("http://")||t[0].rawValue.toLowerCase().startsWith("https://")||t[0].rawValue.toLowerCase().startsWith("mailto:")))window.location.href=t[0].rawValue;else{n.getAttribute("onbarcodedetected-setvalue")&&(n.getAttribute("onbarcodedetected-setformat")&&sircl.ext.$select($(n),n.getAttribute("onbarcodedetected-setformat")).each(function(){this.value=t[0].format}),sircl.ext.$select($(n),n.getAttribute("onbarcodedetected-setvalue")).each(function(){this.value=t[0].rawValue;$(this).trigger("change")}));n.getAttribute("onbarcodedetected-click")&&sircl.ext.$select($(n),n.getAttribute("onbarcodedetected-click")).each(function(){this.click()});var i=new CustomEvent("barcodedetected",{bubbles:!0,detail:{barCodes:t}});n.dispatchEvent(i)}}).catch(function(n){console.error("Sircl .barcode-scanner: error handling barcode detection.",n)})},sircl.barcode_readinterval,n)})};sircl.mediaStopBarcodeScanner=function(n){n!=null&&n._barcodeScannerInterval!=null&&(clearInterval(n._barcodeScannerInterval),n._barcodeScannerInterval=null)};$$("before",function(){$(this).find("VIDEO.barcode-scanner").each(function(){sircl.mediaStopBarcodeScanner(this)})});$$(function(){$(this).find(".ifcanusebarcodescanner-show").each(function(){sircl.ext.visible($(this),"BarcodeDetector"in window,!1)});$(this).find(".ifcanusebarcodescanner-hide").each(function(){sircl.ext.visible($(this),!("BarcodeDetector"in window),!1)});$(this).find("VIDEO.barcode-scanner").each(function(){this.addEventListener("play",function(){sircl.mediaStartBarcodeScanner(this)});this.addEventListener("pause",function(){sircl.mediaStopBarcodeScanner(this)})})});