function SirclRequestProcessor(n){this._steps=[];this._steps=this._steps.concat(sircl._requestHandlers.beforeSend);this._sendIndex=this._steps.length;this._steps.push(this._send);this._steps=this._steps.concat(sircl._requestHandlers.afterSend);this._processIndex=this._steps.length;this._steps.push(this._process);this._steps=this._steps.concat(sircl._requestHandlers.beforeRender);this._renderIndex=this._steps.length;this._steps.push(this._render);this._steps=this._steps.concat(sircl._requestHandlers.afterRender);this._loadComplete=n}function $$(){arguments.length>=2?sircl.addContentReadyHandler(arguments[0],arguments[1]):sircl.addContentReadyHandler("process",arguments[0])}typeof jQuery=="undefined"&&console.error("Sircl requires jQuery to be executed before Sircl libraries. Please add the jQuery script or move it before Sircl scripts.");sircl_originalJqHtml=$.fn.html;$.fn.html=function(n){var t=this,i;return n===undefined?sircl_originalJqHtml.call(t):(t.each(function(){sircl._beforeUnload(this)}),i=sircl_originalJqHtml.call(t,n),n!==null&&t.each(function(){sircl._afterLoad(this)}),i)};sircl_originalJqLoad=$.fn.load;$.fn.load=function(n,t,i){i===undefined&&typeof t=="function"&&(i=t,t=null);var r={$trigger:this,$initialTarget:this,targetMethod:this.attr("target-method")||null,action:n,method:"get",enctype:null,formData:t,isForeground:!1};return sircl._processRequest(r,i),this};$.fn.hasAttr=function(n){return this.attr(n)!==undefined};typeof sircl=="undefined"&&(sircl={});sircl.version=2;console.info("Sircl v."+sircl.version+" running.");sircl.addAttributeAlias=function(n,t,i){sircl.addContentReadyHandler("enrich",function(){$(this).find(n).each(function(){$(this).attr(t,i)})})};sircl.html_spinner='<i class="sircl-spinner sircl-spinning"><\/i> ';sircl.max_redirects=20;sircl.mainTargetSelector$=".main-target";sircl.lastPageNavigationObject=null;sircl.ext={};sircl.ext.firstOrNull=function(n){return n?n.length>0?n[0]:null:null};sircl.ext.visible=function(n,t){if(t===undefined)return!$(n).hasAttr("hidden");t?$(n).removeAttr("hidden"):$(n).attr("hidden","hidden")};sircl.ext.enabled=function(n,t){var i=$(n);if(t===undefined)return i.length>0?i[0].hasAttribute("href")?!i[0].hasAttribute("disabled"):!i.prop("disabled"):!1;i.each(function(){this.hasAttribute("href")?t?i.removeAttr("disabled"):i.attr("disabled","disabled"):i.prop("disabled",!t)})};sircl.ext.getId=function(n,t){var r=$(n),i;return r.length>0?(i=r[0].id,(i===""||i===undefined)&&t===!0&&(i=r[0].id="id-"+(new Date).getTime()),i):null};sircl.ext.effectiveValue=function(n){return n.tagName=="INPUT"&&n.getAttribute("type")=="checkbox"?n.checked?n.value:"":n.tagName=="INPUT"&&n.getAttribute("type")=="radio"?n.checked?n.value:"":$(n).val()||""};sircl.ext.$mainTarget=function(){return $(sircl.mainTargetSelector$)};sircl.ext.isInternalTarget=function(n){if(n==null||n.length==0)return!1;switch(n.charAt(0)){case"#":return!0;case".":return!0;case"*":return!0;case":":return!0;case"<":return!0;case">":return!0;case"&":return!0;case"[":return!0;case" ":return!0;default:return!1}};sircl.ext.isExternalTarget=function(n){return!sircl.ext.isInternalTarget(n)};sircl.ext.$select=function(n,t){var f,r,u,i,e;if(t===undefined||t===null)return $([]);for(f=t.split(","),r=$([]),u=0;u<f.length;u++)i=f[u].trim(),i.length==0||(i.indexOf("|")>=0&&i.indexOf("|=")<i.indexOf("|")?(e=i.indexOf("|"),r=r.add(sircl.ext.$select(sircl.ext.$select(n,i.substr(0,e)),i.substr(e+1)))):r=i===":this"?r.add(n):i===":parent"?r.add(n).parent():i===":form"?n.hasAttr("form")?r.add($("#"+n.attr("form"))):r.add(n.closest("FORM")):i.indexOf(">")===0?r.add(n.find(i.substr(1))):i.indexOf("&gt;")===0?r.add(n.find(i.substr(4))):i.indexOf("<")===0?r.add(n.closest(i.substr(1))):i.indexOf("&lt;")===0?r.add(n.closest(i.substr(4))):r.add($(i)));return r};sircl.ext.cssEscape=function(n){try{return CSS.escape(n)}catch(t){return n.replace(/\./g,"\\.").replace(/\,/g,"\\,").replace(/\:/g,"\\:").replace(/\*/g,"\\*").replace(/\#/g,"\\#").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\[/g,"\\[").replace(/\\/g,"\\\\").replace(/\//g,"\\/").replace(/\%/g,"\\%").replace(/\]/g,"\\]")}};sircl.ext.scopedDo=function(n,t,i){var r,u;try{r=null;t.split(",").forEach(function(t){var u=t.split(" on ").map(function(n){return n.trim()});u.length===1?r==null?i(n,u[0]):i(sircl.ext.$select(n,u[0]),r):i(sircl.ext.$select(n,u[1]),r=u[0])})}catch(f){u=null;n!=null&&n.length>0&&(u=n[0]);sircl.handleError("S151",'Error evaluating class action value "'+t+'" : '+f,{exception:f,element:u})}};sircl.ext.addClass=function(n,t){sircl.ext.scopedDo(n,t,function(n,t){n.addClass(t)})};sircl.ext.removeClass=function(n,t){sircl.ext.scopedDo(n,t,function(n,t){n.removeClass(t)})};sircl.ext.toggleClass=function(n,t){sircl.ext.scopedDo(n,t,function(n,t){n.toggleClass(t)})};sircl.ext.alert=function(n,t){window.alert(t)};sircl.ext.confirm=function(n,t){return window.confirm(t)};sircl.ext.getUrlParameter=function(n){n=n.replace(/[\[]/g,"\\[").replace(/[\]]/g,"\\]");var i=new RegExp("[\\?&]"+n+"=([^&#]*)"),t=i.exec(location.search);return t===null?"":decodeURIComponent(t[1].replace(/\+/g," "))};sircl.ext.submit=function(n,t,i){var o;if($(n).is("FORM:not([download]):not([method=dialog])")){var f=n._formTrigger?$(n._formTrigger):$(n),r=null,e=null,u=$(n);f.hasAttr("formtarget")?(u=f,r=u.attr("formtarget"),e=u.attr("target-method")):f.closest("[target]").length>0&&(u=f.closest("[target]"),r=u.attr("target"),e=u.attr("target-method"));r!=null&&sircl.ext.isInternalTarget(r)||r==null&&sircl.singlePageMode==!0?(o=r!=null?sircl.ext.$select(u,r):sircl.ext.$mainTarget(),sircl._submitForm(f,$(n),o,e,t),t&&(t.preventDefault(),t.stopPropagation())):(sircl._onPageNavigate(t,f,$(n)),i&&i())}else i&&i()};sircl.ext.subtituteFields=function(n,t,i){var s,l,r,f,u,o,e,h,c;if(i==!1||t.hasClass("substitute-fields")){s=t.closest("FORM");s.length==0&&(s=$(document));l=new RegExp(/(\[[a-z0-9\.\-\_]+?\])|(\%5B[a-z0-9\.\-\_]+?\%5D)/gi);r=[];do if(o=l.exec(n),o!==null)r.push(o[0]);else break;while(1);for(u=0;u<r.length;u++){if(o=r[u].charAt(0)==="["?r[u].substr(1,r[u].length-2):r[u].substr(3,r[u].length-6),e=s.find("[name='"+o+"']"),e.length==1)f=sircl.ext.effectiveValue(e[0]);else if(e.length>1){for(f=[],h=0;h<e.length;h++)c=sircl.ext.effectiveValue(e[h]),c!=""&&f.push(c);f=f.join()}else f=null;n=f===null?n.replace(r[u],""):n.replace(r[u],encodeURIComponent(f))}}return n};sircl.urlParser=/^(.*?)(\?.*?)?(\#.*)?$/;sircl._requestHandlers={};sircl._requestHandlers.beforeSend=[];sircl._requestHandlers.afterSend=[];sircl._requestHandlers.onError=[];sircl._requestHandlers.beforeRender=[];sircl._requestHandlers.afterRender=[];sircl.addRequestHandler=function(n,t){this._requestHandlers[n].push(t)};sircl._loadUrl=function(n,t,i,r,u){var f={$trigger:n,$initialTarget:i,targetMethod:r,action:t,method:"get",accept:n.attr("type"),isForeground:!0};this._processRequest(f,u)};sircl._submitForm=function(n,t,i,r,u,f){var e={$form:t,$trigger:n,$initialTarget:i,targetMethod:r,event:u,action:n.attr("formaction")||t.attr("action")||window.location.href,method:(n.attr("formmethod")||t.attr("method")||"get").toLowerCase(),enctype:(n.attr("formenctype")||t.attr("enctype")||"application/x-www-form-urlencoded").toLowerCase(),charset:t.attr("accept-charset"),getAttr:function(n){return this.$trigger.attr(n)||this.$form.attr(n)},isForeground:!0},s=n!=null&&n.is("INPUT:not([type=submit]), SELECT, TEXTAREA"),h,o,c;if(e.method=="post")if(e.enctype=="multipart/form-data"){if(e.formData=new FormData(t[0]),s||n==null||n.attr("name")==null||e.formData.append(n.attr("name"),n.val()),n.length>0&&n[0]._files!=null)for(h=0;h<n[0]._files.length;h++)e.formData.append(n[0]._filesName,n[0]._files[h])}else e.enctype=="text/plain"?(e.formData=t.serialize(),s||n==null||n.attr("name")==null||(e.formData=encodeURIComponent(n.attr("name"))+"="+encodeURIComponent(n.val())+"&"+e.formData)):(e.formData=t.serialize(),s||n==null||n.attr("name")==null||(e.formData=encodeURIComponent(n.attr("name"))+"="+encodeURIComponent(n.val())+"&"+e.formData));else o=sircl.urlParser.exec(e.action),c=!s&&n!=null&&n.attr("name")!=null?encodeURIComponent(n.attr("name"))+"="+encodeURIComponent(n.val())+"&":"",e.action=o[1]+(o[2]?o[2]+"&":"?")+c+t.serialize()+(o[3]?o[3]:""),e.formData=null;this._processRequest(e,f)};sircl._processRequest=function(n,t){var i,r;n.$finalTarget=n.$initialTarget;n.targetHasChanged=!1;n.getAttr==null&&(n.getAttr=function(n){return this.$trigger!=null?this.$trigger.attr(n):null});i=!1;n.$trigger!=null&&n.$trigger.attr("browser-cache")!=null?i=n.$trigger.attr("browser-cache").toLowerCase()=="on":n.$form!=null&&n.$form.attr("browser-cache")!=null&&(i=n.$form.attr("browser-cache").toLowerCase()=="on");n.xhr=new XMLHttpRequest;n.xhr.open(n.method,n.action);typeof n.formData=="object"||(n.enctype==null&&n.charset==null?n.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):n.enctype==null&&n.charset!=null?n.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset="+n.charset):n.enctype!=null&&n.charset==null?n.xhr.setRequestHeader("Content-Type",n.enctype):n.xhr.setRequestHeader("Content-Type",n.enctype+"; charset="+rec.charset));i==!1&&(n.xhr.setRequestHeader("Cache-Control","no-cache, no-store, max-age=0"),n.xhr.setRequestHeader("Pragma","no-cache"));n.xhr.setRequestHeader("Accept",n.accept?n.accept:"text/html");n.xhr.setRequestHeader("X-Sircl-Request-Type","Partial");Intl&&n.xhr.setRequestHeader("X-Sircl-Timezone",Intl.DateTimeFormat().resolvedOptions().timeZone);n.xhr.setRequestHeader("X-Sircl-Timezone-Offset",(new Date).getTimezoneOffset());r=new SirclRequestProcessor(t);r.next(n)};SirclRequestProcessor.prototype.send=function(n){if(arguments.length==0)return this._steps[this._sendIndex];this._steps[this._sendIndex]=n};SirclRequestProcessor.prototype.process=function(n){if(arguments.length==0)return this._steps[this._processIndex];this._steps[this._processIndex]=n};SirclRequestProcessor.prototype.render=function(n){if(arguments.length==0)return this._steps[this._renderIndex];this._steps[this._renderIndex]=n};SirclRequestProcessor.prototype._send=function(n){var t=this;if(n.abort==!0){n.succeeded=!1;n.aborted=!0;t.next(n);return}n.xhr.addEventListener("abort",function(i){n.loadEvent=i;n.status=n.xhr.status;n.statusText=n.xhr.statusText;n.responseText=n.xhr.responseText;n.aborted=!0;n.succeeded=!1;t.next(n)});n.xhr.addEventListener("error",function(i){n.loadEvent=i;n.status=n.xhr.status;n.statusText=n.xhr.statusText;n.responseText=n.xhr.responseText;n.aborted=!1;n.succeeded=!1;t.next(n)});n.xhr.addEventListener("load",function(i){var e,o,f,r,u;n.loadEvent=i;n.status=n.xhr.status;n.statusText=n.xhr.statusText;n.responseText=n.xhr.responseText;e=n.xhr.getResponseHeader("X-Sircl-Load");e!=null&&$(e).filter("[onload-load]").each(function(){$(this).load($(this).attr("onload-load"))});o=n.xhr.getResponseHeader("X-Sircl-Reload-After");o!=null&&parseFloat(o)<=0&&clearInterval(n.$initialTarget[0]._onloadInterval);f=n.xhr.getResponseHeader("Location");f!==null?n.xhr.getResponseHeader("X-Sircl-Target")=="_self"?window.location.href=f:(n.redirects===undefined&&(n.redirects=0),n.redirects++,n.redirects>sircl.max_redirects?(sircl.handleError("S141","Too many redirects.",{request:n}),n.aborted=!0,n.succeeded=!1,t.next(n)):(n.action=f,n.method="get",n.xhr.open(n.method,n.action),n.xhr.setRequestHeader("Accept",n.accept?n.accept:"text/html"),n.xhr.setRequestHeader("Cache-Control","no-cache, no-store, max-age=0"),n.xhr.setRequestHeader("Pragma","no-cache"),n.xhr.setRequestHeader("X-Sircl-Request-Type","Partial"),n.xhr.setRequestHeader("X-Sircl-Timezone-Offset",(new Date).getTimezoneOffset()),n.xhr.send())):(r=n.xhr.getResponseHeader("X-Sircl-Target"),r=="_self"?n.method=="get"?(n.$finalTarget=null,n.targetMethod=null,n.targetHasChanged=!0):console.warn("X-Sircl-Target response header value '_self' is only vaid for 'get' requests."):r=="main"?(n.$finalTarget=sircl.ext.$mainTarget(),n.targetMethod=null,n.targetHasChanged=!0):r!=null&&(n.$finalTarget=sircl.ext.$select(n.$trigger,r),n.targetMethod=null,n.targetHasChanged=!0),n.documentTitle=n.xhr.getResponseHeader("X-Sircl-Document-Title"),n.documentLanguage=n.xhr.getResponseHeader("X-Sircl-Document-Language"),n.alertMsg=n.xhr.getResponseHeader("X-Sircl-Alert-Message"),n.xhr.getResponseHeader("X-Sircl-Target-Method")!==null?n.targetMethod=n.xhr.getResponseHeader("X-Sircl-Target-Method"):n.xhr.getResponseHeader("X-Sircl-Render-Mode")!==null?(n.targetMethod=n.xhr.getResponseHeader("X-Sircl-Render-Mode"),console.warn("X-Sircl-Render-Mode response header is deprecated and replaced by X-Sircl-Target-Method.")):n.targetMethod==null&&n.$finalTarget!=null&&(n.targetMethod=n.$finalTarget.attr("target-method")),u=n.xhr.getResponseHeader("X-Sircl-History"),u=="back"?n.action="history:back":u=="back-uncached"?n.action="history:back-uncached":(u=="reload"||u=="refresh")&&(n.action="history:reload"),n.historyReplace=n.xhr.getResponseHeader("X-Sircl-History-Replace"),n.xhr.status<=299?(n.aborted=!1,n.succeeded=!0,t.next(n)):(n.aborted=!1,n.succeeded=!1,t.error(n)))});n.xhr.send(n.formData)};SirclRequestProcessor.prototype._process=function(n){if(n.historyReplace){var t=window.history.state;t!=null&&(t.url=n.historyReplace);window.history.replaceState(t,document.title,n.historyReplace)}n.alertMsg&&sircl.ext.alert(sircl.ext.firstOrNull(n.$trigger),n.alertMsg,null);n.succeeded&&(n.action=="history:back"?window.history.back():n.action=="history:back-uncached"?(sircl.ext.$mainTarget().addClass("sircl-history-nocache-once"),window.history.back()):n.action=="history:reload"||n.action=="history:refresh"?sircl.singlePageMode==!1||n.$finalTarget==null?window.location.reload():sircl._processRequest({$trigger:null,$initialTarget:sircl.ext.$mainTarget(),targetMethod:null,action:window.location.href,method:"get",isForeground:!0,_historyMode:"skip"}):n.status!="204"&&this.next(n))};SirclRequestProcessor.prototype._render=function(n){var u,f,y,i,h,e,a;n.documentTitle!=null&&(window.document.title=n.documentTitle);n.documentLanguage!=null&&$("HTML").attr("lang",n.documentLanguage);var t=n.$finalTarget,c=n.responseText,v=n.xhr.getResponseHeader("X-Sircl-Sub-Target")||n.getAttr("sub-target"),r=n.$finalTarget.find(v);if(v!=null&&r.length>0){var p=!0,k=$("<div/>").append(n.responseText),s=k.find(v);if(r.length==s.length){for(u=0;u<r.length;u++){for(f=0;f<s.length;f++)if(r[u].hasAttribute("id")&&r[u].id===s[f].id){y=$(s[f]).html();$(r[u]).html()!=y&&$(r[u]).html(y);break}f>=s.length&&(p=!1)}if(p){this.next(n);return}}}if(n.targetMethod==="append")i=t.children().length,t.append(c),t.children().slice(i).each(function(){sircl._afterLoad(this)});else if(n.targetMethod==="prepend")i=t.children().length,t.prepend(c),e=t.children().length,t.children().slice(0,e-i).each(function(){sircl._afterLoad(this)});else if(n.targetMethod==="replace"){var w=t.length==1?sircl.ext.getId(t[0],!1):null,l=t.parent(),b=l.children(),i=b.length,d=sircl.ext.getId(t,!0),o=-1;for(h=0;h<i;h++)if(b[h].id===d){o=h;break}t.replaceWith(c);e=l.children().length;o>-1&&i===e&&w!==null&&(a=l.children()[o],(a.id==null||a.id=="")&&(a.id=w));o>-1&&e>=i&&l.children().slice(o,o+e-i+1).each(function(){sircl._afterLoad(this)})}else t.html(c);n.$finalTarget.each(function(){sircl.ext.visible(this,!0)});this.next(n)};SirclRequestProcessor.prototype.next=function(n){if(this._steps.length>0){var t=this._steps[0];this._steps.splice(0,1);try{t.apply(this,arguments)}catch(i){sircl.handleError("S131","Error executing a RequestProcessor step: "+i,{exception:i,fx:t,request:n});this.next(n)}}else this._loadComplete&&this._loadComplete(n.responseText,n.statusText,n.xhr)};SirclRequestProcessor.prototype.error=function(n){this._steps=sircl._requestHandlers.onError.concat(this._steps);this.next(n)};$(document).ready(function(){sircl.singlePageMode=$(sircl.mainTargetSelector$).length>0;console.info("sircl.singlePageMode = "+sircl.singlePageMode+"");$(document).on("click","*[href][disabled], [onclick-load][disabled]",function(n){n.preventDefault();n.stopPropagation()});$(document).on("click","*[href]:not([download]), [onclick-load]",function(n){var t,r,e,u,f,i,o,s;if($(this).is("[disabled]")){n.preventDefault();n.stopPropagation();return}if(this.hasAttribute("onclick-load")?(t=this.getAttribute("onclick-load"),r=!1):(t=this.getAttribute("href"),r=this.tagName==="A"),e=t,t=sircl.ext.subtituteFields(t,$(this),!0),u=t!=e,t!=="null"&&t!=="")if(t==="history:back")window.history.back();else if(t==="history:back-uncached")sircl.ext.$mainTarget().addClass("sircl-history-nocache-once"),window.history.back();else if(t==="history:reload"||t==="history:refresh")sircl._onPageNavigate(n,$(this)),location.reload();else if(t.indexOf("alert:")===0)sircl.ext.alert(this,t.substr(6),n);else if(t.indexOf("javascript:")===0)f=this.getAttribute("nonce"),f?jQuery.globalEval(t.substr(11),{nonce:f}):jQuery.globalEval(t.substr(11));else{if(r&&t.indexOf("#")===0){sircl._onPageNavigate(n,$(this));return}if(t.indexOf("#")===0)sircl._onPageNavigate(n,$(this)),window.location.hash=t;else if(i=this.getAttribute("target"),i==null&&!sircl.singlePageMode||i!=null&&sircl.ext.isExternalTarget(i))if(sircl._onPageNavigate(n,$(this)),u&&i===null)window.location.href=t;else if(u)window.open(t,i);else{if(r)return;i==null?window.location.href=t:window.open(t,i)}else o=i!=null?sircl.ext.$select($(this),i):sircl.ext.$mainTarget(),s=this.getAttribute("target-method")||null,sircl._loadUrl($(this),t,o,s)}n.preventDefault();n.stopPropagation()});$(document).on("click","*[onclick-reload]",function(n){if($(this).is("[disabled]")){n.preventDefault();n.stopPropagation();return}sircl.ext.$select($(this),$(this).attr("onclick-reload")).filter("[onload-load]").each(function(){var n=$(this).attr("onload-load")+"";$(this).load(n.replace("{rnd}",Math.random()))})});$(document).on("click","form *:submit, *:submit[form]",function(n){if($(this).is("[disabled]")){n.preventDefault();n.stopPropagation();return}var t=this.hasAttribute("form")?document.getElementById(this.getAttribute("form")):$(this).closest("FORM")[0];clearTimeout(t._formTriggerTimer);t._formTrigger=this;t._formTriggerTimer=setTimeout(function(){t._formTrigger=null},700)});sircl.addAttributeAlias(".onclick-submit","onclick-submit",":form");$(document).on("click","*[onclick-submit]",function(n){var i,r,t;(n.preventDefault(),n.stopPropagation(),$(this).is("[disabled]"))||(i=$(this),r=sircl.ext.$select(i,i.attr("onclick-submit")),r.length>=1&&(t=r[0],clearTimeout(t._formTriggerTimer),t._formTrigger=this,t._formTriggerTimer=setTimeout(function(){t._formTrigger=null},700),sircl.ext.submit(t,n,function(){t.submit()})))});$(document).on("submit","form:not([download]):not([method=dialog])",function(n){sircl.ext.submit(this,n)});$(document).on("keydown","[onkeyenter-click]",function(n){if(n.key==="Enter"&&n.target.tagName!=="TEXTAREA"){n.preventDefault();var t=$(this),i=sircl.ext.$select(t,t.attr("onkeyenter-click"));i.length>0&&i[0].click()}});$(document).on("keydown","[onkeyescape-click]",function(n){if(n.key==="Escape"){n.preventDefault();var t=$(this),i=sircl.ext.$select(t,t.attr("onkeyescape-click"));i.length>0&&i[0].click()}});$(document).on("keydown","FORM[default-submit-button] INPUT",function(n){var t,i;n.keyCode==13?(n.preventDefault(),t=$(this).closest("FORM"),i=sircl.ext.$select(t,t.attr("default-submit-button")),i.length>0&&i[0].click()):n.keyCode==27&&(n.preventDefault(),t=$(this).closest("FORM"),i=sircl.ext.$select(t,t.attr("default-cancel-button")),i.length>0&&i[0].click())})});sircl._contentReadyHandlers={};sircl._contentReadyHandlers.before=[];sircl._contentReadyHandlers.content=[];sircl._contentReadyHandlers.enrich=[];sircl._contentReadyHandlers.process=[];sircl.addContentReadyHandler=function(n,t){this._contentReadyHandlers[n].push(t)};sircl._beforeUnload=function(n){sircl._contentReadyHandlers.before.forEach(function(t){try{t.call(n)}catch(i){sircl.handleError("S121","Error executing a BeforeUnLoad handler: "+i,{exception:i,fx:t})}})};sircl._afterLoad=function(n){$(n).addClass("sircl-content-processing");sircl._contentReadyHandlers.content.forEach(function(t){try{t.call(n)}catch(i){sircl.handleError("S122","Error executing an AfterLoad content handler: "+i,{exception:i,fx:t})}});sircl._contentReadyHandlers.enrich.forEach(function(t){try{t.call(n)}catch(i){sircl.handleError("S123","Error executing an AfterLoad enrich handler: "+i,{exception:i,fx:t})}});sircl._contentReadyHandlers.process.forEach(function(t){try{t.call(n)}catch(i){sircl.handleError("S124","Error executing an AfterLoad process handler: "+i,{exception:i,fx:t})}});$(n).removeClass("sircl-content-processing")};sircl._pageNavigateHandlers={};sircl._pageNavigateHandlers.initiate=[];sircl._pageNavigateHandlers.cancel=[];sircl.addPageNavigateHandler=function(n,t){sircl._pageNavigateHandlers[n].push(t)};sircl._onPageNavigate=function(n,t,i){if(t!=null&&t.length>=1&&t.closest(".onnavigate").length>0){var r={event:n,$trigger:t,$form:i};sircl.lastPageNavigationObject=r;sircl._pageNavigateHandlers.initiate.forEach(function(n){try{n.call(null,r)}catch(t){sircl.handleError("S161","Error executing a Page Navigate handler: "+t,{exception:t,fx:n})}})}};sircl.cancelPageNavigate=function(){if(sircl.lastPageNavigationObject!==null){var n=sircl.lastPageNavigationObject;sircl._pageNavigateHandlers.cancel.forEach(function(t){try{t.call(null,n)}catch(i){sircl.handleError("S162","Error executing a Page Navigate cancellation handler: "+i,{exception:i,fx:t})}});sircl.lastPageNavigationObject=null}};$$("content",function(){$(this).filter("[onload-copyto]").add($(this).find("*[onload-copyto]")).each(function(){var n=$(this).html();sircl.ext.$select($(this),$(this).attr("onload-copyto")).html(n)});$(this).filter("[onload-moveto]").add($(this).find("*[onload-moveto]")).each(function(){var n=$(this).html();$(this).html(null);sircl.ext.$select($(this),$(this).attr("onload-moveto")).html(n)})});$$(function(){var n=$(this).find("[document-title]");n.length>0&&(document.title=n[0].getAttribute("document-title"));$(this).find("*[autofocus]:first").each(function(){try{this.focus()}catch(n){}try{this.select()}catch(n){}})});sircl.addAttributeAlias(".target","target",":this");sircl._errorHandlers=[];sircl.addErrorHandler=function(n){this._errorHandlers.push(n)};sircl.handleError=function(n,t,i){i=i||{};this._errorHandlers.forEach(function(r){try{r(n,t,i)}catch(u){console.error("Sircl S999 - Error in error handler.",{exception:u,fx:r})}})};sircl.addErrorHandler(function(n,t,i){console.error("Sircl "+n+" - "+t,i)});sircl._afterHistoryHandlers=[];sircl.addAfterHistoryHandler=function(n){this._afterHistoryHandlers.push(n)};sircl._afterHistory=function(){this._afterHistoryHandlers.forEach(function(n){try{n()}catch(t){sircl.handleError("S125","Error executing an After history handler: "+t,{exception:t,fx:n})}})};sircl.addRequestHandler("beforeRender",function(n){if(n._historyMode!="skip"&&n.method==="get"&&n.$finalTarget.is(sircl.ext.$mainTarget())){n._historyMode=n.getAttr("history")||"push";n._historyCached=n._historyMode.indexOf("cache")>=0;var t={url:window.location.href,html:n._historyCached?n.$finalTarget.html():"",cached:n._historyCached};window.history.replaceState(t,document.title,t.url)}this.next(n)});sircl.addRequestHandler("afterRender",function(n){if(n._historyMode){var t={url:n.action,html:"",cached:!1};n._historyMode.indexOf("skip")>=0||(n._historyMode.indexOf("replace")>=0?(window.history.replaceState(t,document.title,t.url),sircl._afterHistory()):(window.history.pushState(t,document.title,t.url),sircl._afterHistory()))}this.next(n)});$(function(){window.onpopstate=function(n){var t=n.state,i=null;t&&(t.cached&&sircl.ext.$mainTarget().hasClass("sircl-history-nocache-once")?(sircl.ext.$mainTarget().removeClass("sircl-history-nocache-once"),t.cached=!1,i=function(){var n={url:window.location.href,html:sircl.ext.$mainTarget().html(),cached:!0};window.history.replaceState(n,document.title,n.url);sircl._afterHistory()}):i=function(){sircl._afterHistory()},t.cached?(sircl.ext.$mainTarget().html(t.html),sircl._afterHistory()):sircl._processRequest({$trigger:null,$initialTarget:sircl.ext.$mainTarget(),targetMethod:null,action:t.url,method:"get",isForeground:!0,_historyMode:"skip"},i))};sircl._afterHistory()});sircl.addRequestHandler("beforeSend",function(n){n.$trigger!=null&&n.$trigger.length==1&&n.$trigger.is(".onclick-disable")&&(n.$trigger[0].tagName=="BUTTON"||n.$trigger[0].tagName=="INPUT"?(n._disabled_to_restore=n.$trigger[0],n._disabled_to_restore.disabled=!0):(n._disabledclass_to_restore=n.$trigger,sircl.ext.enabled(n._disabledclass_to_restore,!1)));this.next(n)});sircl.addRequestHandler("afterSend",function(n){n._disabled_to_restore&&(n._disabled_to_restore.disabled=!1);n._disabledclass_to_restore&&sircl.ext.enabled(n._disabledclass_to_restore,!0);this.next(n)});sircl.addPageNavigateHandler("initiate",function(n){n.$trigger!=null&&n.$trigger.length==1&&n.$trigger.is(".onclick-disable")&&(n.$trigger[0].tagName=="BUTTON"||n.$trigger[0].tagName=="INPUT"?(n._disabled_to_restore=n.$trigger[0],n._disabled_to_restore.disabled=!0):(n._disabledclass_to_restore=n.$trigger,sircl.ext.enabled(n._disabledclass_to_restore,!1)))});sircl.addPageNavigateHandler("cancel",function(n){n._disabled_to_restore&&(n._disabled_to_restore.disabled=!1);n._disabledclass_to_restore&&sircl.ext.enabled(n._disabledclass_to_restore,!0)});sircl.addRequestHandler("beforeSend",function(n){if(n.$trigger!=null&&n.$trigger.length==1&&n.$trigger[0].tagName!="FORM"){var t=n.$trigger.find("> .spinner");t.length>0&&(n._spinner_to_restore=n.$trigger[0].innerHTML,t[0].outerHTML=sircl.html_spinner)}this.next(n)});sircl.addRequestHandler("afterSend",function(n){n._spinner_to_restore&&(n.$trigger[0].innerHTML=n._spinner_to_restore);this.next(n)});sircl.addPageNavigateHandler("initiate",function(n){if(n.$trigger!=null&&n.$trigger.length==1&&n.$trigger[0].tagName!="FORM"){var t=n.$trigger.find(".spinner");t.length>0&&(n._spinner_to_restore=n.$trigger[0].innerHTML,t[0].outerHTML=sircl.html_spinner)}});sircl.addPageNavigateHandler("cancel",function(n){n._spinner_to_restore&&(n.$trigger[0].innerHTML=n._spinner_to_restore)});sircl.addRequestHandler("beforeSend",function(n){var i=n.$initialTarget.find(".overlay"),t,r,f,e,u,o;if(i.length>0){for(t=i.first(),r=1;r<i.length;r++){for(f=!0,e=$(i[r]).parents(),u=0;u<t.length;u++)if(o=$(t[u]).parent(),e.is(o)){f=!1;break}f&&(t=t.add(i[r]))}t.each(function(){$(this).parent().css("position","relative");sircl.ext.visible(this,!0)})}this.next(n)});sircl.addRequestHandler("afterSend",function(n){var i=n.$initialTarget.find(".overlay"),t,r,f,e,u,o;if(i.length>0){for(t=i.first(),r=1;r<i.length;r++){for(f=!0,e=$(i[r]).parents(),u=0;u<t.length;u++)if(o=$(t[u]).parent(),e.is(o)){f=!1;break}f&&(t=t.add(i[r]))}t.each(function(){sircl.ext.visible(this,!1)})}this.next(n)});sircl.addRequestHandler("beforeSend",function(n){$(document).addClass("body-loading");n.$initialTarget.addClass("loading");this.next(n)});sircl.addRequestHandler("afterSend",function(n){$(document).removeClass("body-loading");n.$initialTarget.removeClass("loading");this.next(n)});$(document).ready(function(){$(window).on("beforeunload",function(){$(document).addClass("body-loading")})});sircl.addRequestHandler("beforeSend",function(n){var t,i;n._progressToResetAfterSend=[];n._progressToHideAfterSend=[];n.xhr!=null&&(t=sircl.ext.$select(n.$initialTarget,n.$initialTarget.attr("upload-progress")).filter("PROGRESS"),t.length>0&&(t.each(function(){this.removeAttribute("value");n._progressToResetAfterSend.push(this);sircl.ext.visible(this)||(n._progressToHideAfterSend.push(this),sircl.ext.visible(this,!0))}),n.xhr.upload.addEventListener("progress",function(n){n.lengthComputable&&t.each(function(){this.value=n.loaded/n.total})})),i=sircl.ext.$select(n.$initialTarget,n.$initialTarget.attr("download-progress")).filter("PROGRESS"),i.length>0&&(i.each(function(){this.removeAttribute("value");n._progressToResetAfterSend.push(this);sircl.ext.visible(this)||(n._progressToHideAfterSend.push(this),sircl.ext.visible(this,!0))}),n.xhr.addEventListener("progress",function(n){n.lengthComputable&&i.each(function(){this.value=n.loaded/n.total})})));this.next(n)});sircl.addRequestHandler("afterSend",function(n){n._progressToHideAfterSend.forEach(function(n){sircl.ext.visible(n,!1)});n._progressToResetAfterSend.forEach(function(n){n.value=0});this.next(n)});sircl.addRequestHandler("afterSend",function(n){if(n.$finalTarget.is(".diffcheck")&&n.succeeded&&n.$finalTarget.length==1){var t=n.$finalTarget[0].sirclDiffCheckCached;t==n.responseText?(n.succeeded=!1,n.aborted=!0):n.$finalTarget[0].sirclDiffCheckCached=n.responseText}this.next(n)});sircl.addRequestHandler("afterRender",function(n){var t,i;n.xhr!=null&&(t=n.xhr.getResponseHeader("X-Sircl-Reload-After"),t&&(i=parseFloat(t),t>0&&n.method=="get"&&setTimeout(function(){n.$finalTarget.load(n.url)},i*1e3)));this.next(n)});sircl.addAttributeAlias(".onclick-closedialog","onclick-closedialog","<DIALOG");$(function(){$(document).on("click","[onclick-showdialog]",function(){var n=sircl.ext.$select($(this),$(this).attr("onclick-showdialog"));n.length>0&&(n.is(".dialog-exclusive")&&$("DIALOG[open]").each(function(){n.is($(this))||this.close()}),n.hasClass("dialog-modal")?n[0].showModal():n[0].show())});$(document).on("click","[onclick-closedialog]",function(){for(var t=sircl.ext.$select($(this),$(this).attr("onclick-closedialog")),n=0;n<t.length;n++)t[n].close()})});sircl.addRequestHandler("beforeSend",function(n){var t=this;n._dialogOpened=n.$initialTarget.closest("DIALOG.beforeload-showdialog:not([open])");n._dialogOpened.length>0&&(n._dialogOpened.is(".dialog-exclusive")&&$("DIALOG[open]").each(function(){$(this).is(n.$finalTarget)||this.close()}),n._dialogOpened.hasClass("dialog-modal")?n._dialogOpened[0].showModal():n._dialogOpened[0].show());t.next(n)});sircl.addRequestHandler("afterSend",function(n){var i=this,t;!n.succeeded&&n._dialogOpened.length>0?(n._dialogOpened[0].close(),n._dialogOpened=$([])):n.status=="204"&&(t=n.$initialTarget.closest("DIALOG[open]"),t.length>0&&t[0].close());i.next(n)});sircl.addRequestHandler("beforeRender",function(n){var i=this,t;n.targetHasChanged&&n._dialogOpened.length>0&&(n.$finalTarget.has(n._dialogOpened)||(n._dialogOpened[0].close(),n._dialogOpened=$([])));t=n.$finalTarget.closest("DIALOG");t.is(".dialog-exclusive")&&$("DIALOG[open]").each(function(){t.is($(this))||this.close()});n.isForeground==!0&&t.length==0&&n.$trigger!=null&&n.$trigger.length>0&&n.$trigger.closest("DIALOG").length>0&&n.$trigger.closest("DIALOG")[0].close();i.next(n)});sircl.addRequestHandler("afterRender",function(n){var i=this,t=n.$finalTarget.closest("DIALOG:not([open])");t.length>0&&(t.hasClass("dialog-modal")?t[0].showModal():t[0].show());i.next(n)});$$(function(){$(this).find("DIALOG").each(function(n,t){t.addEventListener("cancel",function(n){$(this).is(".dialog-nocancel")&&n.preventDefault()})});$(this).find("DIALOG.onclose-restore").each(function(n,t){t._originalContent=$(t).html();t.addEventListener("close",function(){var n=this._originalContent;n!==undefined&&$(this).html(n)})});$(this).find("DIALOG[onload-showdialogafter]").each(function(){for(var n=0,i=$(this).attr("onload-showdialogafter").split(":"),t=0;t<i.length;t++)n=parseFloat(i[t])+60*n;setTimeout(function(n){var t=$(n);t.is(".dialog-exclusive")&&$("DIALOG[open]").each(function(){t.is($(this))||this.close()});t.hasClass("dialog-modal")?n.showModal():n.show()},n*1e3,this)})});sircl.addAttributeAlias(".oninput-change","oninput-changeafter","0.8");sircl.addAttributeAlias(".onchange-submit","onchange-submit",":form");$(function(){$(document).on("change","[onchange-submit]",function(n){if($(n.target).closest(".onchange-nosubmit").length==0&&$(n.target).closest(".sircl-content-processing").length==0){var t=sircl.ext.$select($(this),$(this).attr("onchange-submit"));t.length>0&&(t[0]._formTrigger=this,t[0]._formTriggerTimer=setTimeout(function(){t[0]._formTrigger=null},700),sircl.ext.submit(t[0],null,function(){t[0].submit()}))}});$(document).on("input","INPUT[oninput-changeafter], TEXTAREA[oninput-changeafter]",function(){var n=1e3*$(this).attr("oninput-changeafter");this._oninput_changeafter_timeout&&clearTimeout(this._oninput_changeafter_timeout);this._oninput_changeafter_timeout=setTimeout(function(n){$(n).change()},n,this)});$(document.body).on("change","INPUT[oninput-changeafter], TEXTAREA[oninput-changeafter]",function(n){var t=$(this).val(),i=this._previousChangeValue;t===i?(n.preventDefault(),n.stopPropagation()):this._previousChangeValue=t})});sircl.addAttributeAlias(".onsubmit-disable","onsubmit-disable",">:submit");sircl.addRequestHandler("beforeSend",function(n){n.$form&&n.$form.hasAttr("onsubmit-disable")&&(n._formSubmitsToReenable=[],sircl.ext.$select(n.$form,n.$form.attr("onsubmit-disable")).filter(":not([disabled])").each(function(){n._formSubmitsToReenable.push(this);sircl.ext.enabled(this,!1)}));this.next(n)});sircl.addRequestHandler("afterSend",function(n){n._formSubmitsToReenable&&n._formSubmitsToReenable.forEach(function(n){sircl.ext.enabled(n,!0)});this.next(n)});sircl.addPageNavigateHandler("initiate",function(n){n.$form&&n.$form.hasAttr("onsubmit-disable")&&(n._formSubmitsToReenable=[],sircl.ext.$select(n.$form,n.$form.attr("onsubmit-disable")).filter(":not([disabled])").each(function(){n._formSubmitsToReenable.push(this);sircl.ext.enabled(this,!1)}))});sircl.addPageNavigateHandler("cancel",function(n){n._formSubmitsToReenable&&n._formSubmitsToReenable.forEach(function(n){sircl.ext.enabled(n,!0)})});$(function(){$(document.body).on("click","*[onclick-propagate=off]",function(n){n.stopPropagation()});$(document.body).on("dblclick","*[ondblclick-propagate=off]",function(n){n.stopPropagation()});$(document.body).on("change","*[onchange-propagate=off]",function(n){n.stopPropagation()});$(document.body).on("input","*[oninput-propagate=off]",function(n){n.stopPropagation()})});sircl.addAttributeAlias(".onload-click","onload-click",":this");$$(function(){$(this).find("[onload-click]").each(function(){sircl.ext.$select($(this),$(this).attr("onload-click")).each(function(){this.click()})});$(this).find("[onload-load]").each(function(){var n=$(this).attr("onload-load")+"",r,u,t,i;if(n=sircl.ext.subtituteFields(n,$(this),!0),$(this).load(n.replace("{rnd}",Math.random())),r=$(this).attr("onload-reloadafter"),r){for(u=r.split(":"),t=0,i=0;i<u.length;i++)t=parseFloat(u[i])+60*t;$(this)[0]._onloadInterval=window.setInterval(function(t){t.load(n.replace("{rnd}",Math.random()))},t*1e3,$(this))}else $(this).is(".noreload")&&$(this).removeAttr("onload-load")});$(this).find("[onload-reload]").each(function(){$($(this).attr("onload-reload")).filter("[onload-load]").each(function(){var n=$(this).attr("onload-load")+"";$(this).load(n.replace("{rnd}",Math.random()))})})});$$(function(){$(this).find("FORM[onchange-set]").each(function(){var n=$(this).find("INPUT[name='"+$(this).attr("onchange-set")+"']");n.length>0&&["true","on"].indexOf((n.val()||"false").toLowerCase())>=0&&$(this).addClass("form-changed")})});sircl.addRequestHandler("afterRender",function(n){if(n!=null&&n.xhr!=null){var t=n.xhr.getResponseHeader("X-Sircl-Form-Changed");t!==null&&t.toLowerCase()==="true"&&n.$finalTarget.closest("FORM[onchange-set]").each(function(){$(this).addClass("form-changed");var n=$(this).find("INPUT[name='"+$(this).attr("onchange-set")+"']");n.length>0&&n.val(!0)})}this.next(n)});$(function(){$(document).on("change","FORM[onchange-set]",function(n){if($(n.target).closest(".sircl-content-processing").length==0){$(this).addClass("form-changed");var t=$(this).find("INPUT[name='"+$(this).attr("onchange-set")+"']");t.length>0&&t.val(!0)}});$(document.body).on("click","*[href]:not(.onunloadchanged-allow):not([download])",function(n){var t=$("FORM.form-changed[onunloadchanged-confirm]"),i;t.length>0&&(i=t[0].getAttribute("onunloadchanged-confirm"),sircl.ext.confirm(this,i,n)||(n.stopPropagation(),n.preventDefault()))});$(document.body).on("click","FORM.form-changed *[onclickchanged-confirm]",function(n){var t=$(this).attr("onclickchanged-confirm");sircl.ext.confirm(this,t,n)||(n.stopPropagation(),n.preventDefault())})});$(document).ready(function(){setTimeout(function(n){$("BODY").addClass("sircl-content-processing");sircl._afterLoad(n);$("BODY").removeClass("sircl-content-processing")},0,this)});