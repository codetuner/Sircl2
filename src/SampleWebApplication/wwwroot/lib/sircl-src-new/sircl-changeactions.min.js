typeof sircl=="undefined"&&console.warn("The 'sircl-changeactions' component should be registered after the 'sircl' component. Please review order of script files.");sircl.disableOnAction=!1;sircl._changeActionHandlers={};sircl._changeActionHandlers.beforeSend=[];sircl._changeActionHandlers.afterSend=[];sircl._changeActionHandlers.onError=[];sircl._changeActionHandlers.beforeRender=[];sircl._changeActionHandlers.afterRender=[];sircl.addChangeActionHandler=function(n,t){sircl._changeActionHandlers[n].push(t)};sircl._runChangeActionHandlers=function(n,t,i){sircl._changeActionHandlers[n].forEach(function(n){n.apply(t,[i])})};sircl._actionCall=function(n,t,i,r,u,f,e,o,s,h,c,l){var g,v,d,rt,tt,y,nt,w,k,b,p,it,a;if(!($(o.target).closest(".sircl-content-processing").length>0)){if(g=($(n).closest("[method]").attr("method")||"get").toUpperCase()=="POST"?"POST":"GET",r=r.replace("{rnd}",Math.random()),v=[],i.hasClass("substitute-fields")){d=$(n).closest("FORM");d.length==0&&(d=$(document));rt=new RegExp(/(\[[a-z0-9\.\-\_]+?\])|(\%5B[a-z0-9\.\-\_]+?\%5D)/gi);do if(tt=rt.exec(r),tt!==null)v.push(tt[0]);else break;while(1);for(y=0;y<v.length;y++)nt=v[y].charAt(0)==="["?d.find("[name='"+v[y].substr(1,v[y].length-2)+"']").val():d.find("[name='"+v[y].substr(3,v[y].length-6)+"']").val(),r=nt===undefined?r.replace(v[y],""):v[y].charAt(0)==="["?r.replace(v[y],nt):r.replace(v[y],encodeURIComponent(nt))}for((f===null||f===undefined)&&(f=[]),Array.isArray(f)||(f=[f]),w=[],k=[],u!=null&&u!=""&&u.toLowerCase()!="name"&&(w.push("name"),k.push(encodeURIComponent(u))),p=0;p<f.length;p++)w.push("value"),k.push(encodeURIComponent(f[p])),e===null&&u!=null&&u!=""&&u.toLowerCase()!="value"&&(w.push(encodeURIComponent(u)),k.push(encodeURIComponent(f[p])));for(e!=null&&v.indexOf("checked")==-1&&(w.push("checked"),k.push(e)),b="",p=0;p<w.length;p++)p>0&&(b+="&"),b+=w[p]+"="+k[p];g==="GET"&&b.length>0&&(r=r+(r.indexOf("?")<0?"?":"&")+b,b=null);it=!1;$(n).attr("browser-cache")!=null&&(it=$(n).attr("browser-cache").toLowerCase()=="on");a={$trigger:$(n),$subjects:t,$scope:i,event:o};a.xhr=new XMLHttpRequest;a.xhr.open(g,r);g!=="GET"&&a.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");it==!1&&(a.xhr.setRequestHeader("Cache-Control","no-cache, no-store, max-age=0"),a.xhr.setRequestHeader("Pragma","no-cache"));a.xhr.setRequestHeader("X-Sircl-Request-Type","ChangeAction");a.xhr.setRequestHeader("X-Sircl-Timezone-Offset",(new Date).getTimezoneOffset());var ft=function(t){a.loadEvent=t;a.succeeded=a.xhr.status<=299?!0:!1;var i=a.xhr.getResponseHeader("Content-Type")||"";a.data=i.indexOf("json")>=0?JSON.parse(a.xhr.responseText):i.indexOf("html")>=0?a.xhr.responseText:null;sircl._runChangeActionHandlers("afterSend",n,a);sircl._runChangeActionHandlers("beforeRender",n,a);a.succeeded||sircl._runChangeActionHandlers("onError",n,a);a.succeeded?i.indexOf("json")>=0?s&&s.apply(n,[a]):i.indexOf("html")>=0&&h&&h.apply(n,[a]):c&&c.apply(n);sircl._runChangeActionHandlers("afterRender",n,a);a.succeeded||sircl.handleError("S311","Change action request failed.",{request:a})},ut=function(t){a.loadEvent=t;a.succeeded=!1;a.data=null;sircl._runChangeActionHandlers("afterSend",n,a);sircl._runChangeActionHandlers("beforeRender",n,a);a.succeeded||sircl._runChangeActionHandlers("onError",n,a);a.succeeded?(a.xhr.getResponseHeader("Content-Type")||"").indexOf("text/html")==0?h&&h.apply(n,[a]):s&&s.apply(n,[a]):c&&c.apply(n);sircl._runChangeActionHandlers("afterRender",n,a);a.succeeded||sircl.handleError("S311","Change action request failed.",{request:a})},et=function(){l&&l.apply(n)};a.xhr.addEventListener("abort",ut);a.xhr.addEventListener("error",ut);a.xhr.addEventListener("load",ft);a.xhr.addEventListener("loadend",et);sircl._runChangeActionHandlers("beforeSend",n,a);a.xhr.send(b)}};$(function(){$(document).on("change","INPUT[type=radio][onchange-action]",function(n){var t=$(this);sircl._actionCall(this,t,t,t.attr("onchange-action"),this.name,t.attr("value"),t.prop("checked"),n,function(){this._previousActionValue=t.prop("checked")},function(n){sircl.ext.$select(n.$scope,n.$scope.attr("target")).html(n.data)},function(){t.prop("checked",!t.prop("checked"))})});$(document).on("change","[onchange-action] INPUT[type=radio]:not([onchange-action])",function(n){var r=$(this),i=r.closest("[onchange-action]"),t=i.find("INPUT[type=radio][name='"+this.name+"']:not([onchange-action])");sircl._actionCall(this,t,i,i.attr("onchange-action"),this.name,jQuery.makeArray(t.filter(":checked")).map(function(n){return n.value}),null,n,function(n){var i=n.data;Array.isArray(i)&&i.length>0&&(i=i[0]);i===undefined?t[0]._previousActionValue=this.value:i==null||i==""?(t.prop("checked",!1),t[0]._previousActionValue=null):(t.filter("[value='"+i+"']").prop("checked",!0),t[0]._previousActionValue=i)},function(n){sircl.ext.$select(n.$scope,n.$scope.attr("target")).html(n.data)},function(){var n=i.find("INPUT[type=radio][name='"+this.name+"']:not([onchange-action]):first")[0]._previousActionValue;n?i.find("INPUT[type=radio][name='"+this.name+"'][value='"+n+"']:not([onchange-action])").prop("checked",!0):i.find("INPUT[type=radio][name='"+this.name+"']:not([onchange-action])").prop("checked",!1)})});$(document).on("change","INPUT[type=checkbox][onchange-action]",function(n){var t=$(this);sircl._actionCall(this,t,t,t.attr("onchange-action"),this.name,t.attr("value"),t.prop("checked"),n,function(){this._previousActionValue=t.prop("checked")},function(n){sircl.ext.$select(n.$scope,n.$scope.attr("target")).html(n.data)},function(){t.prop("checked",!t.prop("checked"))})});$(document).on("change","[onchange-action] INPUT[type=checkbox]:not([onchange-action])",function(n){var t=$(this),i=t.closest("[onchange-action]"),r=i.find("INPUT[type=checkbox][name='"+this.name+"']:not([onchange-action])");sircl._actionCall(this,r,i,i.attr("onchange-action"),this.name,jQuery.makeArray(i.find("INPUT[type=checkbox][name='"+this.name+"']:checked:not([onchange-action])")).map(function(n){return n.value}),null,n,function(n){var i=n.data;typeof i=="string"&&(i=[i]);Array.isArray(i)?r.each(function(){var n=i.indexOf(this.value)>=0;$(this).prop("checked",n);this._previousActionValue=n}):this._previousActionValue=t.prop("checked")},function(n){sircl.ext.$select(n.$scope,n.$scope.attr("target")).html(n.data)},function(){t.prop("checked",!t.prop("checked"))})});$(document).on("change","INPUT[onchange-action]:not([type=checkbox]):not([type=radio]):not([type=button]), [onchange-action] INPUT:not([type=checkbox]):not([type=radio]):not([type=button]):not([onchange-action]), SELECT[onchange-action], [onchange-action] SELECT:not([onchange-action]), TEXTAREA[onchange-action], [onchange-action] TEXTAREA:not([onchange-action])",function(n){var t=$(this),i=t.closest("[onchange-action]");sircl._actionCall(this,t,i,i.attr("onchange-action"),this.name,t.val(),null,n,function(n){var i=n.data;i&&t.val(i);this._previousActionValue=t.val()},function(n){sircl.ext.$select(n.$scope,n.$scope.attr("target")).html(n.data)},function(){t.val(this._previousActionValue)})});$(document).on("focusin","INPUT[onfocus-action]:not([type=checkbox]):not([type=radio]):not([type=button]), TEXTAREA[onfocus-action]",function(n){var t=$(this),i=t.closest("[onfocus-action]");sircl._actionCall(this,t,i,i.attr("onfocus-action"),this.name,t.val(),null,n,function(n){var i=n.data;if(i){t.val(i);try{this.select()}catch(r){}}},function(n){sircl.ext.$select(n.$scope,n.$scope.attr("target")).html(n.data)})});$(document).on("focusout","INPUT[onfocusout-action]:not([type=checkbox]):not([type=radio]):not([type=button]), TEXTAREA[onfocusout-action]",function(n){var t=$(this),i=t.closest("[onfocusout-action]");sircl._actionCall(this,t,i,i.attr("onfocusout-action"),this.name,t.val(),null,n,function(n){var i=n.data;i&&t.val(i)},function(n){sircl.ext.$select(n.$scope,n.$scope.attr("target")).html(n.data)})})});$$(function(){$(this).find("INPUT[onchange-action]").each(function(){this._previousActionValue=$(this).is("[type=radio]")?$(this).prop("checked"):$(this).is("[type=checkbox]")?$(this).prop("checked"):$(this).val()});$(this).find("[onchange-action] INPUT:not([onchange-action])").each(function(){var n=$(this).closest("[onchange-action]");$(this).is("[type=radio]")?n.find("INPUT[type=radio][name='"+this.name+"']:not([onchange-action]):first")[0]._previousActionValue=$("INPUT[type=radio][name='"+this.name+"']:not([onchange-action]):checked").val():this._previousActionValue=$(this).is("[type=checkbox]")?$(this).prop("checked"):$(this).val()});$(this).find("TEXTAREA[onchange-action], [onchange-action] TEXTAREA:not([onchange-action])").each(function(){this._previousActionValue=$(this).val()});$(this).find("SELECT[onchange-action], [onchange-action] SELECT:not([onchange-action])").each(function(){this._previousActionValue=$(this).val()})});sircl.addChangeActionHandler("afterSend",function(n){var t=n.xhr.getResponseHeader("X-Sircl-Alert-Message");t&&sircl.ext.alert(n.$trigger,t,null,!0)});sircl.addChangeActionHandler("beforeSend",function(n){n._elemetsDisabled=sircl.disableOnAction&&n.event.type!="focusin"&&n.event.type!="focusout"&&n.event.type!="input"?n.$subjects.filter(":not(:disabled)"):$(null);n._elemetsDisabled.prop("disabled",!0)});sircl.addChangeActionHandler("afterSend",function(n){n._elemetsDisabled.prop("disabled",!1)});sircl.addChangeActionHandler("beforeSend",function(n){n.$scope.addClass("action-pending")});sircl.addChangeActionHandler("afterSend",function(n){n.$scope.removeClass("action-pending")});